import{_ as e}from"./uni-section.Cn4ZJI-v.js";import{r as l,G as a,h as t,j as u,a as o,b as i,k as s,w as d,J as n,c as r,B as v,K as c,A as p,F as m,d as f,z as y,e as b,t as h,y as g,L as _,i as F,S,H as x,p as k}from"./index-DP-g-T74.js";import{_ as V,r as j}from"./_plugin-vue_export-helper.BJC6Dhmg.js";import{_ as B}from"./uni-icons.DQjyCcaB.js";import{_ as T}from"./cl-input.DOOSgXgY.js";const C=V({__name:"cl-select",props:{options:{type:Array,default:()=>[]},labelField:{type:String,default:"label"},valueField:{type:String,default:"value"},modelValue:{type:[String,Number],default:void 0},placeholder:{type:String,default:"请选择"},maxHeight:{type:[String,Number],default:300},placeholderStyle:{type:String,default:""},disabled:{type:Boolean,default:!1},maxlength:{type:Number,default:20},trim:{type:String,default:"both"},hideBorder:{type:Boolean,default:!1},cursorSpacing:{type:Number,default:0},emptyText:{type:String,default:"暂无数据"},filterable:{type:Boolean,default:!0}},emits:["update:modelValue","focus","blur","selected","clear","input"],setup(e,{emit:k}){const V=e,C=k,I=l(!1),H=l({}),N=l(),w=l(),A=a((()=>0!==Object.keys(H.value).length)),$=l(),z=l([]),O=a((()=>V.options.map((e=>"object"!=typeof e?{[V.valueField]:e,[V.labelField]:e}:e)))),U=()=>{H.value={},console.log(V.options[0][V.valueField]),C("clear")},G=l(V.placeholder),J=()=>{V.disabled||(A.value?G.value=H.value[V.labelField]:G.value=V.placeholder,I.value=!0,z.value=O.value,N.value=void 0)},K=e=>{A.value?G.value=H.value[V.labelField]:G.value=V.placeholder,I.value=!0,z.value=O.value,N.value=void 0,C("focus",e)},L=()=>{A.value?N.value=H.value[V.labelField]:N.value=void 0,C("blur")};let q=null;const D=e=>{clearTimeout(q),q=setTimeout((()=>{z.value=O.value.filter((l=>l[V.labelField].includes(e))),C("input",e)}),200)};t((()=>I.value),(e=>{e&&x((()=>{A.value?(G.value=H.value[V.labelField],$.value=H.value[V.valueField]):(G.value=V.placeholder,O.value.length>0&&($.value=O.value[0][V.valueField]))}))})),t((()=>H.value),(e=>{0===Object.keys(e).length?(N.value=void 0,w.value=void 0,G.value=V.placeholder):(N.value=e[V.labelField],w.value=e[V.valueField]),C("update:modelValue",w.value)}));const E=e=>""===e||null==e;t([()=>V.options,()=>V.modelValue],(()=>{(()=>{if(O.value.length>0&&!E(V.modelValue)){const e=O.value.find((e=>e[V.valueField]===V.modelValue));e&&(H.value=e)}})()}),{deep:!0,immediate:!0});const M=e=>{I.value=!1};return(l,a)=>{const t=j(u("uni-icons"),B),x=F,k=j(u("cl-input"),T),w=S;return o(),i(m,null,[s(x,{class:"el_select"},{default:d((()=>[s(k,{class:"cl_input",modelValue:N.value,"onUpdate:modelValue":a[0]||(a[0]=e=>N.value=e),placeholder:G.value,inputType:e.filterable?"input":"falseInput",placeholderStyle:e.placeholderStyle,disabled:e.disabled,maxlength:e.maxlength,trim:e.trim,inputBorder:!e.hideBorder,cursorSpacing:e.cursorSpacing,onFocus:K,onInput:D,onBlur:L,onInputClick:J,onClear:U},n({_:2},[e.filterable?{name:"right",fn:d((()=>[e.disabled?v("",!0):(o(),r(x,{key:0,class:"icons"},{default:d((()=>[!A.value||I.value?(o(),r(t,{key:0,type:I.value?"top":"bottom",size:"14",color:"#999"},null,8,["type"])):v("",!0)])),_:1}))])),key:"0"}:void 0]),1032,["modelValue","placeholder","inputType","placeholderStyle","disabled","maxlength","trim","inputBorder","cursorSpacing"]),c(s(x,{class:"scroll_list"},{default:d((()=>[s(x,{class:"triangle_icon"}),s(w,{"scroll-y":"","scroll-into-view":$.value,style:p({maxHeight:e.maxHeight+"px"})},{default:d((()=>[(o(!0),i(m,null,f(z.value,((l,a)=>(o(),r(x,{class:y(["select_item",{active:l[e.valueField]===H.value[e.valueField]}]),key:a,onClick:e=>(e=>{H.value=e,I.value=!1,C("selected",e[V.valueField],e)})(l),id:l[e.valueField]},{default:d((()=>[b(h(l[e.labelField]),1)])),_:2},1032,["class","onClick","id"])))),128)),0===z.value.length?g(l.$slots,"empty",{key:0},(()=>[s(x,{class:"empty_text"},{default:d((()=>[b(h(e.emptyText),1)])),_:1})]),!0):v("",!0)])),_:3},8,["scroll-into-view","style"])])),_:3},512),[[_,I.value]])])),_:3}),I.value?(o(),r(x,{key:0,class:"mask",onClick:M})):v("",!0)],64)}}},[["__scopeId","data-v-13aadeb2"]]),I=V({__name:"index",setup(a){const t=l(),i=Array.from({length:100},((e,l)=>({label:`我是展示的值${l}`,value:`value${l}`})));return(l,a)=>{const n=j(u("uni-section"),e),v=j(u("cl-select"),C),c=F;return o(),r(c,{class:"content"},{default:d((()=>[s(n,null,{default:d((()=>[b("模仿uni-data-select做的可搜索下拉框，可直接回显数据，并定位到对应的数据项")])),_:1}),s(v,{options:k(i),modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value=e)},null,8,["options","modelValue"]),b(" "+h(t.value),1)])),_:1})}}},[["__scopeId","data-v-f7b34a4e"]]);export{I as default};
