{"version":3,"file":"cl-select.js","sources":["uni_modules/cl-select/components/cl-select/cl-select.vue","../../../soft/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovY29kZS9jb2RlLWxpZmUvdW5pLWFwcC1jb21wb25lbnRzL3VuaV9tb2R1bGVzL2NsLXNlbGVjdC9jb21wb25lbnRzL2NsLXNlbGVjdC9jbC1zZWxlY3QudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"el_select\">\r\n\t\t<cl-input class=\"cl_input\" v-model=\"curSelectLabel\" :placeholder=\"showPlaceholder\"\r\n\t\t\t:inputType=\"filterable ? 'input' :  'falseInput'\" :placeholderStyle=\"placeholderStyle\" :disabled=\"disabled\"\r\n\t\t\t:maxlength=\"maxlength\" :trim=\"trim\" :inputBorder=\"!hideBorder\" :cursorSpacing=\"cursorSpacing\" @focus=\"focusHandle\"\r\n\t\t\t@input=\"inputHandle\" @blur=\"blurHandle\" @inputClick=\"inputClick\" @clear=\"clearHandle\">\r\n\t\t\t<template #right v-if=\"filterable\">\r\n\t\t\t\t<view class=\"icons\" v-if=\"!disabled\">\r\n\t\t\t\t\t<uni-icons v-if=\"!isSelected || visible\" :type=\"visible ? 'top' : 'bottom'\" size=\"14\"\r\n\t\t\t\t\t\tcolor=\"#999\"></uni-icons>\r\n\t\t\t\t</view>\r\n\t\t\t</template>\r\n\t\t</cl-input>\r\n\t\t<view class=\"scroll_list\" v-show=\"visible\">\r\n\t\t\t<view class=\"triangle_icon\"></view>\r\n\t\t\t<scroll-view scroll-y :scroll-into-view=\"scrollIntoView\" :style=\"{maxHeight: maxHeight + 'px'}\">\r\n\t\t\t\t<view class=\"select_item\" :class=\"{active: item[valueField] === curSelect[valueField]}\"\r\n\t\t\t\t\tv-for=\"(item, index) in showOptions\" :key=\"index\" @click=\"selected(item)\" :id=\"item[valueField]\">\r\n\t\t\t\t\t{{item[labelField]}}\r\n\t\t\t\t</view>\r\n\t\t\t\t<slot name=\"empty\" v-if=\"showOptions.length === 0\">\r\n\t\t\t\t\t<view class=\"empty_text\">\r\n\t\t\t\t\t\t{{emptyText}}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</slot>\r\n\t\t\t</scroll-view>\r\n\t\t</view>\r\n\t</view>\r\n\t<view class=\"mask\" @click=\"maskClick\" v-if=\"visible\"></view>\r\n</template>\r\n<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\twatch,\r\n\t\tcomputed,\r\n\t\tnextTick,\r\n\t\tonMounted,\r\n\t\tgetCurrentInstance\r\n\t} from 'vue'\r\n\tconst curInstance = getCurrentInstance()\r\n\tconst props = defineProps({\r\n\t\toptions: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: () => []\r\n\t\t},\r\n\t\tlabelField: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'label'\r\n\t\t},\r\n\t\tvalueField: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'value'\r\n\t\t},\r\n\t\tmodelValue: {\r\n\t\t\ttype: [String, Number],\r\n\t\t\tdefault: undefined\r\n\t\t},\r\n\t\tplaceholder: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: '请选择'\r\n\t\t},\r\n\t\tmaxHeight: {\r\n\t\t\ttype: [String, Number],\r\n\t\t\tdefault: 300\r\n\t\t},\r\n\t\tplaceholderStyle: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\tdisabled: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t},\r\n\t\tmaxlength: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 20\r\n\t\t},\r\n\t\ttrim: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'both'\r\n\t\t},\r\n\t\thideBorder: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t},\r\n\t\tcursorSpacing: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0\r\n\t\t},\r\n\t\temptyText: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: '暂无数据'\r\n\t\t},\r\n\t\tfilterable: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t}\r\n\t})\r\n\r\n\tconst emits = defineEmits(['update:modelValue', 'focus', 'blur', 'selected', 'clear', 'input'])\r\n\r\n\t// 控制下拉框\r\n\tconst visible = ref(false)\r\n\t// 当前选中的数据\r\n\tconst curSelect = ref({})\r\n\tconst curSelectLabel = ref()\r\n\tconst curSelectValue = ref()\r\n\tconst isSelected = computed(() => {\r\n\t\tif (Object.keys(curSelect.value).length === 0) {\r\n\t\t\treturn false\r\n\t\t} else {\r\n\t\t\treturn true\r\n\t\t}\r\n\t})\r\n\r\n\t// 定位到某个元素\r\n\tconst scrollIntoView = ref()\r\n\t// 展示的下拉数据\r\n\tconst showOptions = ref([])\r\n\t// 格式化的下拉列表数据\r\n\tconst formatOptions = computed(() => {\r\n\t\treturn props.options.map(item => {\r\n\t\t\tif (typeof item !== 'object') {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t[props.valueField]: item,\r\n\t\t\t\t\t[props.labelField]: item\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn item\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\r\n\t// 选中数据\r\n\tconst selected = (item) => {\r\n\t\tcurSelect.value = item\r\n\t\tvisible.value = false\r\n\t\temits('selected', item[props.valueField], item)\r\n\t}\r\n\t// 清除\r\n\tconst clearHandle = () => {\r\n\t\t// 清除所选项跟定位元素\r\n\t\tcurSelect.value = {}\r\n\t\tconsole.log(props.options[0][props.valueField]);\r\n\r\n\t\temits('clear')\r\n\t}\r\n\tconst showPlaceholder = ref(props.placeholder)\r\n\t// 输入框点击（不可搜索的状态）\r\n\tconst inputClick = () => {\r\n\t\tif (isSelected.value) {\r\n\t\t\tshowPlaceholder.value = curSelect.value[props.labelField]\r\n\t\t} else {\r\n\t\t\tshowPlaceholder.value = props.placeholder\r\n\t\t}\r\n\t\tvisible.value = true\r\n\t\t// 如果数据不是对象则转为对象\r\n\t\tshowOptions.value = formatOptions.value\r\n\t\tcurSelectLabel.value = undefined\r\n\t}\r\n\t// 聚焦函数\r\n\tconst focusHandle = (inputVal) => {\r\n\t\tif (isSelected.value) {\r\n\t\t\tshowPlaceholder.value = curSelect.value[props.labelField]\r\n\t\t} else {\r\n\t\t\tshowPlaceholder.value = props.placeholder\r\n\t\t}\r\n\t\tvisible.value = true\r\n\t\t// 如果数据不是对象则转为对象\r\n\t\tshowOptions.value = formatOptions.value\r\n\t\tcurSelectLabel.value = undefined\r\n\t\temits('focus', inputVal)\r\n\t}\r\n\t// 失去焦点\r\n\tconst blurHandle = () => {\r\n\t\tif (isSelected.value) {\r\n\t\t\tcurSelectLabel.value = curSelect.value[props.labelField]\r\n\t\t} else {\r\n\t\t\tcurSelectLabel.value = undefined\r\n\t\t}\r\n\t\temits('blur')\r\n\t}\r\n\t// 添加防抖逻辑\r\n\tlet searchTimer = null\r\n\tconst inputHandle = (e) => {\r\n\t\tclearTimeout(searchTimer)\r\n\t\tsearchTimer = setTimeout(() => {\r\n\t\t\tshowOptions.value = formatOptions.value.filter(item => item[props.labelField].includes(e))\r\n\t\t\temits('input', e)\r\n\t\t}, 200)\r\n\t}\r\n\r\n\t// 监听下拉框是否显示\r\n\twatch(() => visible.value, (val) => {\r\n\t\tif (val) {\r\n\t\t\t// 监听是否有选中的值，有则替换Placeholder进行展示并定位到对应元素\r\n\t\t\tnextTick(() => {\r\n\t\t\t\tif (isSelected.value) {\r\n\t\t\t\t\tshowPlaceholder.value = curSelect.value[props.labelField]\r\n\t\t\t\t\tscrollIntoView.value = curSelect.value[props.valueField]\r\n\t\t\t\t} else {\r\n\t\t\t\t\tshowPlaceholder.value = props.placeholder\r\n\t\t\t\t\tif (formatOptions.value.length > 0) {\r\n\t\t\t\t\t\tscrollIntoView.value = formatOptions.value[0][props.valueField]\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t})\r\n\r\n\twatch(() => curSelect.value, (val) => {\r\n\t\tif (Object.keys(val).length === 0) {\r\n\t\t\tcurSelectLabel.value = undefined\r\n\t\t\tcurSelectValue.value = undefined\r\n\t\t\tshowPlaceholder.value = props.placeholder\r\n\t\t} else {\r\n\t\t\tcurSelectLabel.value = val[props.labelField]\r\n\t\t\tcurSelectValue.value = val[props.valueField]\r\n\t\t}\r\n\t\temits('update:modelValue', curSelectValue.value)\r\n\t})\r\n\t// 回显数据\r\n\tconst setCurSelect = () => {\r\n\t\tif (formatOptions.value.length > 0 && !isEmpty(props.modelValue)) {\r\n\t\t\tconst data = formatOptions.value.find(item => item[props.valueField] === props.modelValue)\r\n\t\t\tif (data) {\r\n\t\t\t\tcurSelect.value = data\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// 工具函数\r\n\tconst isEmpty = (val) => {\r\n\t\treturn val === '' || val === undefined || val === null\r\n\t}\r\n\twatch([() => props.options, () => props.modelValue], () => {\r\n\t\tsetCurSelect()\r\n\t}, {\r\n\t\tdeep: true,\r\n\t\timmediate: true,\r\n\t})\r\n\r\n\tconst maskClick = (e) => {\r\n\t\tvisible.value = false\r\n\t}\r\n</script>\r\n<style scoped>\r\n\t.el_select {\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t.scroll_list {\r\n\t\tposition: absolute;\r\n\t\ttop: calc(100% + 12px);\r\n\t\tleft: 0;\r\n\t\twidth: 100%;\r\n\t\tbackground-color: #fff;\r\n\t\tborder: 1px solid #ebeef5;\r\n\t\tborder-radius: 6px;\r\n\t\tbox-shadow: 0 2px 12px 0 rgba(0, 0, 0, .1);\r\n\t\tz-index: 3;\r\n\t\tpadding: 4px 0;\r\n\t}\r\n\r\n\t.triangle_icon {\r\n\t\tposition: absolute;\r\n\t\twidth: 10px;\r\n\t\theight: 10px;\r\n\t\tbackground-color: #fff;\r\n\t\tborder: 1px solid #ebeef5;\r\n\t\tborder-right: none;\r\n\t\tborder-bottom: none;\r\n\t\tleft: 10%;\r\n\t\ttop: -6px;\r\n\t\ttransform: rotate(45deg);\r\n\t}\r\n\r\n\t.icons {\r\n\t\tposition: relative;\r\n\t\tmargin-right: 5px;\r\n\t}\r\n\r\n\t.select_item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 0 5px;\r\n\t\tmin-height: 35px;\r\n\t\tfont-size: 14px;\r\n\t}\r\n\r\n\t.active {\r\n\t\tbackground-color: #f9f9f9;\r\n\t}\r\n\r\n\t.empty_text {\r\n\t\ttext-align: center;\r\n\t\tline-height: 30px;\r\n\t\tcolor: gray;\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\r\n\t.mask {\r\n\t\topacity: .5;\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tbottom: 0;\r\n\t\tright: 0;\r\n\t}\r\n</style>","import Component from 'D:/code/code-life/uni-app-components/uni_modules/cl-select/components/cl-select/cl-select.vue'\nwx.createComponent(Component)"],"names":["ref","computed","uni","watch","nextTick"],"mappings":"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"}