{"version":3,"file":"cl-date-picker.js","sources":["uni_modules/cl-date-picker/components/cl-date-picker/cl-date-picker.vue","../../../soft/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovY29kZS9jb2RlLWxpZmUvdW5pLWFwcC1jb21wb25lbnRzL3VuaV9tb2R1bGVzL2NsLWRhdGUtcGlja2VyL2NvbXBvbmVudHMvY2wtZGF0ZS1waWNrZXIvY2wtZGF0ZS1waWNrZXIudnVl"],"sourcesContent":["<template>\r\n\t<cl-input v-model=\"modelValue\" inputType=\"falseInput\" :placeholder=\"placeholder\" :disabled=\"disabled\" v-bind=\"atrrs\"\r\n\t\t@inputClick=\"handleOpen\">\r\n\t\t<template #right>\r\n\t\t\t<uni-icons v-if=\"!modelValue && !disabled\" type=\"bottom\" :size=\"14\" color=\"#999\"></uni-icons>\r\n\t\t</template>\r\n\t</cl-input>\r\n\t<uni-popup type=\"bottom\" ref=\"popupRef\">\r\n\t\t<view class=\"btn_box\">\r\n\t\t\t<text @click=\"cancal\">取消</text>\r\n\t\t\t<text class=\"submit\" @click=\"handleSubmit\">确认</text>\r\n\t\t</view>\r\n\t\t<picker-view class=\"picker-view\" :value=\"dateVal\" @change=\"dateChange\" mask-class=\"mask_class\">\r\n\t\t\t<picker-view-column v-for=\"(item, index) in dateOptionList\" :key=\"index\">\r\n\t\t\t\t<view class=\"item\" v-for=\"(itm, idx) in item.options\" :key=\"idx\">\r\n\t\t\t\t\t{{ itm }}\r\n\t\t\t\t\t{{ dateLabelMap[item.type] }}\r\n\t\t\t\t</view>\r\n\t\t\t</picker-view-column>\r\n\t\t</picker-view>\r\n\t</uni-popup>\r\n</template>\r\n<script setup>\r\n\timport {\r\n\t\tcomputed,\r\n\t\tnextTick,\r\n\t\treactive,\r\n\t\tref,\r\n\t\tuseAttrs,\r\n\t\twatch\r\n\t} from 'vue'\r\n\timport {\r\n\t\tonLoad\r\n\t} from '@dcloudio/uni-app'\r\n\tconst props = defineProps({\r\n\t\tdateType: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'YYYY-MM-DD',\r\n\t\t},\r\n\t\tplaceholder: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: '请选择',\r\n\t\t},\r\n\t\tclearable: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t},\r\n\t\t// 年份下拉选项\r\n\t\tyearOptions: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: () => ([])\r\n\t\t},\r\n\t\t// 打开弹窗默认选中当前时间\r\n\t\tisNow: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t},\r\n\t\tdisabled: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t}\r\n\t})\r\n\r\n\tconst atrrs = useAttrs()\r\n\tconsole.log(atrrs);\r\n\tconst modelValue = defineModel()\r\n\tconst emits = defineEmits(['cancel', 'submit'])\r\n\tconst popupRef = ref()\r\n\tconst dateOptionList = ref([])\r\n\t// 存储的时间下拉值，也就是选项的下标\r\n\tconst dateVal = ref([])\r\n\tconst dateLabelMap = {\r\n\t\tYYYY: '年',\r\n\t\tMM: '月',\r\n\t\tDD: '日',\r\n\t\thh: '时',\r\n\t\tmm: '分',\r\n\t\tss: '秒',\r\n\t}\r\n\tconst dateTypeMap = [{\r\n\t\t\ttype: 'YYYY',\r\n\t\t\tregExp: /^\\d{4}$/,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'YYYY-MM',\r\n\t\t\tregExp: /^\\d{4}-\\d{2}$/,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'YYYY-MM-DD',\r\n\t\t\tregExp: /^\\d{4}-\\d{2}-\\d{2}/,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'YYYY-MM-DD HH',\r\n\t\t\tregExp: /^\\d{4}-\\d{2}-\\d{2} \\d{2}$/,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'YYYY-MM-DD HH:mm',\r\n\t\t\tregExp: /^\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}$/,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'YYYY-MM-DD HH:mm:ss',\r\n\t\t\tregExp: /^\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}$/,\r\n\t\t},\r\n\t]\r\n\tconst isEmpty = (val) => {\r\n\t\treturn val === null || val === '' || val === undefined\r\n\t}\r\n\t// 补0的函数\r\n\tconst supplementZero = (num) => {\r\n\t\treturn num >= 10 ? num + '' : '0' + num\r\n\t}\r\n\t// 获取当前时间对象\r\n\tconst getNowDate = () => {\r\n\t\tconst now = new Date();\r\n\t\tconst YYYY = now.getFullYear() + '';\r\n\t\tconst MM = supplementZero(now.getMonth() + 1); // 月份从 0 开始，需要加 1\r\n\t\tconst DD = supplementZero(now.getDate())\r\n\t\tconst hh = supplementZero(now.getHours())\r\n\t\tconst mm = supplementZero(now.getMinutes())\r\n\t\tconst ss = supplementZero(now.getSeconds())\r\n\t\treturn {\r\n\t\t\tYYYY,\r\n\t\t\tMM,\r\n\t\t\tDD,\r\n\t\t\thh,\r\n\t\t\tmm,\r\n\t\t\tss\r\n\t\t}\r\n\t}\r\n\r\n\t// 获取时间类型列表\r\n\tconst dateTypetList = computed(() => {\r\n\t\tconst regex = /(YYYY|MM|DD|hh|mm|ss)/g;\r\n\t\tconst matches = props.dateType.match(regex);\r\n\t\treturn matches || [];\r\n\t})\r\n\t// 获取时间值列表\r\n\tconst dataValList = computed(() => {\r\n\t\tconst regex = /(\\d{4}|\\d{2}|\\d{2}|\\d{2}|\\d{2}|\\d{2})/g;\r\n\t\tconst matches = props.modelValue.match(regex);\r\n\t\treturn matches || [];\r\n\t})\r\n\t// 创建时间选项\r\n\tconst createDateOptions = () => {\r\n\t\tdateOptionList.value = []\r\n\t\tconst date = new Date()\r\n\t\tif (dateTypetList.value.length === 0) {\r\n\t\t\tthrow new Error('传入的时间格式无法识别到有效值，有效值包含：YYYY,MM,DD,hh,mm,ss')\r\n\t\t\treturn false\r\n\t\t}\r\n\t\tdateTypetList.value.forEach((item, index) => {\r\n\t\t\tlet options = []\r\n\t\t\t// 设置年份选项\r\n\t\t\tif (item === 'YYYY') {\r\n\t\t\t\tif (props.yearOptions.length === 0) {\r\n\t\t\t\t\tfor (let i = 1990; i <= 2050; i++) {\r\n\t\t\t\t\t\toptions.push(i + '')\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\toptions = props.yearOptions\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// 设置月份选项\r\n\t\t\tif (item === 'MM') {\r\n\t\t\t\tfor (let i = 1; i <= 12; i++) {\r\n\t\t\t\t\toptions.push(supplementZero(i))\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// 设置天数选项\r\n\t\t\tif (item === 'DD') {\r\n\t\t\t\tfor (let i = 1; i <= 31; i++) {\r\n\t\t\t\t\toptions.push(supplementZero(i))\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// 设置小时选项\r\n\t\t\tif (item === 'hh') {\r\n\t\t\t\tfor (let i = 0; i <= 23; i++) {\r\n\t\t\t\t\toptions.push(supplementZero(i))\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// 设置分钟秒钟选项\r\n\t\t\tif (item === 'mm' || item === 'ss') {\r\n\t\t\t\tfor (let i = 0; i <= 59; i++) {\r\n\t\t\t\t\toptions.push(supplementZero(i))\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdateOptionList.value.push({\r\n\t\t\t\ttype: item,\r\n\t\t\t\toptions\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\t// 获取对应下表进行时间回显\r\n\tconst showDate = () => {\r\n\t\tdateVal.value = []\r\n\t\tdateTypetList.value.forEach((item, index) => {\r\n\t\t\tconst curOption = dateOptionList.value.find(itm => itm.type === item)\r\n\t\t\tconst curData = curOption.options.findIndex(itm => itm === dataValList.value[index])\r\n\t\t\tdateVal.value.push(curData)\r\n\t\t})\r\n\t}\r\n\tconst dateChange = ({\r\n\t\tdetail\r\n\t}) => {\r\n\t\tconsole.log(detail, 'detail');\r\n\t\tdateVal.value = detail.value\r\n\t}\r\n\t// 取消按钮\r\n\tconst cancal = () => {\r\n\t\temits('cancel')\r\n\t\tpopupRef.value.close()\r\n\t}\r\n\t// 提交按钮\r\n\tconst handleSubmit = () => {\r\n\t\tlet str = props.dateType\r\n\t\tdateTypetList.value.forEach((item, index) => {\r\n\t\t\tconst reg = new RegExp(item)\r\n\t\t\tconst curOption = dateOptionList.value.find(itm => itm.type === item)\r\n\t\t\tconsole.log(curOption, 'curOption');\r\n\t\t\tconst curData = curOption.options[dateVal.value[index]]\r\n\t\t\tstr = str.replace(reg, curData)\r\n\t\t})\r\n\t\temits('submit', str)\r\n\t\tmodelValue.value = str\r\n\t\tpopupRef.value.close()\r\n\t}\r\n\t// 打开弹窗\r\n\tconst handleOpen = () => {\r\n\t\tcreateDateOptions()\r\n\t\tif (isEmpty(props.modelValue)) {\r\n\t\t\tif (props.isNow) {\r\n\t\t\t\tlet nowDateIdxList = []\r\n\t\t\t\tconst nowDateMap = getNowDate()\r\n\t\t\t\tdateTypetList.value.forEach(item => {\r\n\t\t\t\t\tconst curOption = dateOptionList.value.find(itm => itm.type === item)\r\n\t\t\t\t\tlet curIdx = curOption.options.findIndex(itm => itm === nowDateMap[item])\r\n\t\t\t\t\tnowDateIdxList.push(curIdx)\r\n\t\t\t\t})\r\n\t\t\t\tdateVal.value = nowDateIdxList\r\n\t\t\t} else {\r\n\t\t\t\tdateVal.value = []\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tnextTick(() => showDate())\r\n\t\t}\r\n\t\tpopupRef.value.open()\r\n\t}\r\n\r\n\t// 关闭弹窗\r\n\tconst close = () => {\r\n\t\tpopupRef.value.close()\r\n\t}\r\n\tdefineExpose({\r\n\t\tclose,\r\n\t\topen: handleOpen,\r\n\t})\r\n\t// 清除所选数据\r\n\tconst handleClear = () => {\r\n\t\tmodelValue.value = ''\r\n\t}\r\n</script>\r\n<!-- 这里没有使用任何css编译器，方便在其他环境使用 -->\r\n<style scoped lang=\"scss\"> \r\n\t.picker-view {\r\n\t\twidth: 100%;\r\n\t\theight: 500rpx;\r\n\t\tbackground-color: #fff;\r\n\t}\r\n\r\n\t.btn_box {\r\n\t\tpadding: 20rpx;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tbackground-color: #fff;\r\n\t\tfont-size: 28rpx;\r\n\r\n\t\t.submit {\r\n\t\t\tcolor: #007aff;\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t.item {\r\n\t\tflex: 1;\r\n\t\tline-height: 70rpx;\r\n\t\ttext-align: center;\r\n\t\tfont-size: 26rpx;\r\n\t}\r\n</style>","import Component from 'D:/code/code-life/uni-app-components/uni_modules/cl-date-picker/components/cl-date-picker/cl-date-picker.vue'\nwx.createComponent(Component)"],"names":["useAttrs","uni","_useModel","ref","computed","nextTick"],"mappings":"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"}